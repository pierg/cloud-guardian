{
  "permissions": {
    "IAM": {
      "CreateUser": {
        "allowed_between": [
          {
            "source": ["User", "Role"],
            "target": ["User"]
          }
        ],
        "flow_enabler": true,
        "description": "Actions that can create new users, potentially allowing unauthorized access.",
        "regex_aws_action": "iam:(CreateRole)",
        "actions": [
            {"create_node" : {
              "type": "User"
            }}
          ]
      },
      "CreateRole": {
        "allowed_between": [
          {
            "source": ["User", "Role"],
            "target": ["Role"]
          }
        ],
        "flow_enabler": true,
        "description": "Actions that can create new roles, potentially allowing unauthorized access.",
        "regex_aws_action": "iam:(CreateRole)"
      }
    },
    "Storage": {
      "BucketPolicyManagement": {
        "allowed_between": [
          {
            "source": ["User", "Role"],
            "target": ["Storage"]
          }
        ],
        "flow_enabler": true,
        "description": "Modification of storage bucket policies, which if misconfigured, can lead to unauthorized access escalation.",
        "regex_aws_action": "s3:(PutBucketPolicy|DeleteBucketPolicy)"
      },
      "BucketOperations": {
        "allowed_between": [
          {
            "source": ["User", "Role"],
            "target": ["Storage"]
          }
        ],
        "flow_enabler": false,
        "description": "Operations on storage buckets including listing and retrieving objects without changing permissions.",
        "regex_aws_action": "s3:(ListBucket|GetObject)"
      }
    },
    "KeyManagement": {
      "KeyPolicyManagement": {
        "allowed_between": [
          {
            "source": ["User", "Role"],
            "target": ["KeyManagement"]
          }
        ],
        "flow_enabler": true,
        "description": "Involves the management of key policies, essential for securing key access and potentially escalating privileges by allowing access to encrypted data.",
        "regex_aws_action": "kms:(PutKeyPolicy|DeleteKeyPolicy)"
      },
      "KeyOperations": {
        "allowed_between": [
          {
            "source": ["User", "Role"],
            "target": ["KeyManagement"]
          }
        ],
        "flow_enabler": false,
        "description": "Key operations that involve viewing and using encryption keys without altering access controls or policies.",
        "regex_aws_action": "kms:(DescribeKey|UseKey)"
      }
    }
  }
}
